<!DOCTYPE html>
<html lang="en">
  <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />

    <title>system-test</title>

    <meta charset="utf-8" />
    <link href="http://ioos.github.io/system-test//feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="system-test Full Atom Feed" />
    <link href="http://ioos.github.io/system-test//atom.xml" type="application/atom+xml" rel="alternate" title="system-test Atom Feed" />
    <link href="http://ioos.github.io/system-test//feeds/misc.atom.xml" type="application/atom+xml" rel="alternate" title="system-test Categories Atom Feed" />
    <link rel="stylesheet" href="/theme/css/poole.css"/>
    <link rel="stylesheet" href="/theme/css/syntax.css"/>
    <link rel="stylesheet" href="/theme/css/lanyon.css"/>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
    <link rel="stylesheet" href="/theme/css/styles.css"/>




  </head>

  <body>
<!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">
<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <div class="profile">
      <img src="/theme/img/profile.png"/>
    </div>
  </div>

  <nav class="sidebar-nav">
  <a class="sidebar-nav-item" href="/">All</a>

      <a class="sidebar-nav-item" href="/category/misc.html">misc</a>

  <a class="sidebar-nav-item" href="http://www.noaa.gov/">NOAA</a>
  <a class="sidebar-nav-item" href="http://www.ioos.noaa.gov/">IOOS</a>
  </nav>

  <div class="sidebar-item">
    <p>
    <a href="https://twitter.com/">&copy; @</a> 2015
    </p>
    <p class="tiny-note">
      <a class="muted" href="https://github.com/thomaswilley/pelicanyan">pelicanyan v0.1</a>
    </p>
  </div>
</div>    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">system-test</a>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="posts">
<div class="post">
    <h1 class="post-title">
      Catalog based search for the IOOS Regional Associations acronyms
    </h1>
    <span class="post-date">Nov 23, 2015</span>

    <p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The goal of this post is to investigate if it is possible to query the NGDC CSW Catalog to extract records matching an IOOS RA acronym, like SECOORA for example.</p>
<p>In the cell above we do the usual: instantiate a Catalogue Service Web (<code>csw</code>) using the <a href="https://www.ngdc.noaa.gov/">NGDC</a> catalog endpoint.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">from</span> <span class="nn">owslib.csw</span> <span class="kn">import</span> <span class="n">CatalogueServiceWeb</span>

<span class="n">endpoint</span> <span class="o">=</span> <span class="s">&#39;http://www.ngdc.noaa.gov/geoportal/csw&#39;</span>
<span class="n">csw</span> <span class="o">=</span> <span class="n">CatalogueServiceWeb</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We need a list of all the Regional Associations we know.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">ioos_ras</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;AOOS&#39;</span><span class="p">,</span>      <span class="c"># Alaska</span>
            <span class="s">&#39;CaRA&#39;</span><span class="p">,</span>      <span class="c"># Caribbean</span>
            <span class="s">&#39;CeNCOOS&#39;</span><span class="p">,</span>   <span class="c"># Central and Northern California</span>
            <span class="s">&#39;GCOOS&#39;</span><span class="p">,</span>     <span class="c"># Gulf of Mexico</span>
            <span class="s">&#39;GLOS&#39;</span><span class="p">,</span>      <span class="c"># Great Lakes</span>
            <span class="s">&#39;MARACOOS&#39;</span><span class="p">,</span>  <span class="c"># Mid-Atlantic</span>
            <span class="s">&#39;NANOOS&#39;</span><span class="p">,</span>    <span class="c"># Pacific Northwest </span>
            <span class="s">&#39;NERACOOS&#39;</span><span class="p">,</span>  <span class="c"># Northeast Atlantic </span>
            <span class="s">&#39;PacIOOS&#39;</span><span class="p">,</span>   <span class="c"># Pacific Islands </span>
            <span class="s">&#39;SCCOOS&#39;</span><span class="p">,</span>    <span class="c"># Southern California</span>
            <span class="s">&#39;SECOORA&#39;</span><span class="p">]</span>   <span class="c"># Southeast Atlantic</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To streamline the query we can create a function that instantiate the <code>fes</code> filter and returns the records.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">from</span> <span class="nn">owslib.fes</span> <span class="kn">import</span> <span class="n">PropertyIsEqualTo</span>

<span class="k">def</span> <span class="nf">query_ra</span><span class="p">(</span><span class="n">csw</span><span class="p">,</span> <span class="n">ra</span><span class="o">=</span><span class="s">&#39;SECOORA&#39;</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">PropertyIsEqualTo</span><span class="p">(</span><span class="n">propertyname</span><span class="o">=</span><span class="s">&#39;apiso:Keywords&#39;</span><span class="p">,</span> <span class="n">literal</span><span class="o">=</span><span class="n">ra</span><span class="p">)</span>
    <span class="n">csw</span><span class="o">.</span><span class="n">getrecords2</span><span class="p">(</span><span class="n">constraints</span><span class="o">=</span><span class="p">[</span><span class="n">q</span><span class="p">],</span> <span class="n">maxrecords</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">esn</span><span class="o">=</span><span class="s">&#39;full&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">csw</span>
</pre></div>

</div>
</div>
</div>

</div>
                Here is what we got:
                
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="k">for</span> <span class="n">ra</span> <span class="ow">in</span> <span class="n">ioos_ras</span><span class="p">:</span>
    <span class="n">csw</span> <span class="o">=</span> <span class="n">query_ra</span><span class="p">(</span><span class="n">csw</span><span class="p">,</span> <span class="n">ra</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">csw</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s">&#39;returned&#39;</span><span class="p">]</span>
    <span class="n">word</span> <span class="o">=</span> <span class="s">&#39;records&#39;</span> <span class="k">if</span> <span class="n">ret</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s">&#39;record&#39;</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;{0:&gt;8} has {1:&gt;3} {2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">ret</span><span class="p">,</span> <span class="n">word</span><span class="p">))</span>
    <span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
    AOOS has   1 record
    CaRA has   0 record
 CeNCOOS has   7 records
   GCOOS has   5 records
    GLOS has  15 records
MARACOOS has 100 records
  NANOOS has   1 record
NERACOOS has 100 records
 PacIOOS has   0 record
  SCCOOS has  23 records
 SECOORA has  71 records

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I would not trust those number completely.
Surely some of the RA listed above have more than 0/1 record.</p>
<p>Note that we have more information in the <code>csw.records</code>.
Let&#39;s inspect one of SECOORA&#39;s stations for example.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">csw</span> <span class="o">=</span> <span class="n">query_ra</span><span class="p">(</span><span class="n">csw</span><span class="p">,</span> <span class="s">&#39;SECOORA&#39;</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
id_usf.tas.ngwlms

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can verify the station type, title, and last date of modification.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">station</span> <span class="o">=</span> <span class="n">csw</span><span class="o">.</span><span class="n">records</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

<span class="n">station</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">station</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">station</span><span class="o">.</span><span class="n">modified</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[8]:</div>


<div class="output_text output_subarea output_pyout">
<pre>
(&apos;downloadableData&apos;, &apos;usf.tas.ngwlms&apos;, &apos;2015-11-25T01:32:42-07:00&apos;)
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>subjects</code> field contains the variables and some useful keywords.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">station</span><span class="o">.</span><span class="n">subjects</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[9]:</div>


<div class="output_text output_subarea output_pyout">
<pre>
[&apos;air_pressure&apos;,
 &apos;air_temperature&apos;,
 &apos;water_surface_height_above_reference_datum&apos;,
 &apos;wind_from_direction&apos;,
 &apos;wind_speed_of_gust&apos;,
 &apos;wind_speed&apos;,
 &apos;SECOORA&apos;,
 &apos;air_pressure&apos;,
 &apos;air_temperature&apos;,
 &apos;water_surface_height_above_reference_datum&apos;,
 &apos;wind_from_direction&apos;,
 &apos;wind_speed_of_gust&apos;,
 &apos;wind_speed&apos;,
 &apos;latitude&apos;,
 &apos;longitude&apos;,
 &apos;time&apos;,
 &apos;climatologyMeteorologyAtmosphere&apos;]
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And we can access the full <code>XML</code> description for the station.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="k">print</span><span class="p">(</span><span class="n">station</span><span class="o">.</span><span class="n">xml</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
&lt;csw:Record xmlns:csw=&quot;http://www.opengis.net/cat/csw/2.0.2&quot; xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot; xmlns:dcmiBox=&quot;http://dublincore.org/documents/2000/07/11/dcmi-box/&quot; xmlns:dct=&quot;http://purl.org/dc/terms/&quot; xmlns:gml=&quot;http://www.opengis.net/gml&quot; xmlns:ows=&quot;http://www.opengis.net/ows&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;
&lt;dc:identifier scheme=&quot;urn:x-esri:specification:ServiceType:ArcIMS:Metadata:FileID&quot;&gt;id_usf.tas.ngwlms&lt;/dc:identifier&gt;
&lt;dc:identifier scheme=&quot;urn:x-esri:specification:ServiceType:ArcIMS:Metadata:DocID&quot;&gt;{9DDE8E32-EB36-4E72-B2CC-A47D51151271}&lt;/dc:identifier&gt;
&lt;dc:title&gt;usf.tas.ngwlms&lt;/dc:title&gt;
&lt;dc:type scheme=&quot;urn:x-esri:specification:ServiceType:ArcIMS:Metadata:ContentType&quot;&gt;downloadableData&lt;/dc:type&gt;
&lt;dc:type scheme=&quot;urn:x-esri:specification:ServiceType:ArcIMS:Metadata:ContentType&quot;&gt;liveData&lt;/dc:type&gt;
&lt;dc:subject&gt;air_pressure&lt;/dc:subject&gt;
&lt;dc:subject&gt;air_temperature&lt;/dc:subject&gt;
&lt;dc:subject&gt;water_surface_height_above_reference_datum&lt;/dc:subject&gt;
&lt;dc:subject&gt;wind_from_direction&lt;/dc:subject&gt;
&lt;dc:subject&gt;wind_speed_of_gust&lt;/dc:subject&gt;
&lt;dc:subject&gt;wind_speed&lt;/dc:subject&gt;
&lt;dc:subject&gt;SECOORA&lt;/dc:subject&gt;
&lt;dc:subject&gt;air_pressure&lt;/dc:subject&gt;
&lt;dc:subject&gt;air_temperature&lt;/dc:subject&gt;
&lt;dc:subject&gt;water_surface_height_above_reference_datum&lt;/dc:subject&gt;
&lt;dc:subject&gt;wind_from_direction&lt;/dc:subject&gt;
&lt;dc:subject&gt;wind_speed_of_gust&lt;/dc:subject&gt;
&lt;dc:subject&gt;wind_speed&lt;/dc:subject&gt;
&lt;dc:subject&gt;latitude&lt;/dc:subject&gt;
&lt;dc:subject&gt;longitude&lt;/dc:subject&gt;
&lt;dc:subject&gt;time&lt;/dc:subject&gt;
&lt;dc:subject&gt;climatologyMeteorologyAtmosphere&lt;/dc:subject&gt;
&lt;dct:modified&gt;2015-11-25T01:32:42-07:00&lt;/dct:modified&gt;
&lt;dct:references scheme=&quot;urn:x-esri:specification:ServiceType:distribution:url&quot;&gt;http://tds.secoora.org/thredds/dodsC/usf.tas.ngwlms.nc.html&lt;/dct:references&gt;
&lt;dct:references scheme=&quot;urn:x-esri:specification:ServiceType:distribution:url&quot;&gt;http://www.ncdc.noaa.gov/oa/wct/wct-jnlp-beta.php?singlefile=http://tds.secoora.org/thredds/dodsC/usf.tas.ngwlms.nc&lt;/dct:references&gt;
&lt;dct:references scheme=&quot;urn:x-esri:specification:ServiceType:sos:url&quot;&gt;http://tds.secoora.org/thredds/sos/usf.tas.ngwlms.nc?service=SOS&amp;amp;version=1.0.0&amp;amp;request=GetCapabilities&lt;/dct:references&gt;
&lt;dct:references scheme=&quot;urn:x-esri:specification:ServiceType:odp:url&quot;&gt;http://tds.secoora.org/thredds/dodsC/usf.tas.ngwlms.nc&lt;/dct:references&gt;
&lt;dct:references scheme=&quot;urn:x-esri:specification:ServiceType:download:url&quot;&gt;http://tds.secoora.org/thredds/dodsC/usf.tas.ngwlms.nc.html&lt;/dct:references&gt;
&lt;ows:WGS84BoundingBox&gt;
&lt;ows:LowerCorner&gt;-82.75800323486328 28.1560001373291&lt;/ows:LowerCorner&gt;
&lt;ows:UpperCorner&gt;-82.75800323486328 28.1560001373291&lt;/ows:UpperCorner&gt;
&lt;/ows:WGS84BoundingBox&gt;
&lt;ows:BoundingBox&gt;
&lt;ows:LowerCorner&gt;-82.75800323486328 28.1560001373291&lt;/ows:LowerCorner&gt;
&lt;ows:UpperCorner&gt;-82.75800323486328 28.1560001373291&lt;/ows:UpperCorner&gt;
&lt;/ows:BoundingBox&gt;
&lt;dc:source&gt;{B3EA8869-B726-4E39-898A-299E53ABBC98}&lt;/dc:source&gt;
&lt;/csw:Record&gt;


</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This query is very simple, but also very powerful.
We can quickly assess the data available for a certain Regional Association data with just a few line of code.</p>
<p>You can see the original notebook <a href="https://www.wakari.io/sharing/bundle/emayorga/NGDC_CSW_QueryForIOOSRAs">here</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight-ipynb"><pre class="ipynb"><span class="n">HTML</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[11]:</div>

<div class="output_html rendered_html output_subarea output_pyout">

<small>
<p> This post was written as an IPython notebook.  It is available for
<a href="http://ioos.github.com/system-test/downloads/
notebooks/2015-11-23-NGDC_CSW_QueryForIOOSRAs.ipynb">download</a>.  You can also try an interactive version on
<a href="http://mybinder.org/repo/ioos/system-test/">binder</a>.</p>
<p></p>

</div>

</div>

</div>
</div>

</div></p>
  </div>
</div>
      </div>

      <label for="sidebar-checkbox" class="sidebar-toggle"></label>

      <script>
        (function(document) {
          var i = 0;
          // snip empty header rows since markdown can't
          var rows = document.querySelectorAll('tr');
          for(i=0; i<rows.length; i++) {
            var ths = rows[i].querySelectorAll('th');
            var rowlen = rows[i].children.length;
            if (ths.length > 0 && ths.length === rowlen) {
              rows[i].remove();
            }
          }
        })(document);
      </script>

      <script>
        /* Lanyon & Poole are Copyright (c) 2014 Mark Otto. Adapted to Pelican 20141223 and extended a bit by @thomaswilley */
        (function(document) {
          var toggle = document.querySelector('.sidebar-toggle');
          var sidebar = document.querySelector('#sidebar');
          var checkbox = document.querySelector('#sidebar-checkbox');
          document.addEventListener('click', function(e) {
            var target = e.target;
            if(!checkbox.checked ||
            sidebar.contains(target) ||
            (target === checkbox || target === toggle)) return;
            checkbox.checked = false;
            }, false);
            })(document);
      </script>
     </div>
  </body>
</html>